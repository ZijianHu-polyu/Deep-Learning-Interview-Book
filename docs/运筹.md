[TOC]

# 运筹优化

## 单纯形法
### 基本解法
+ 单纯形法是解决线性规划问题的一般方法。
+ 相关概念：
    + 将优化问题转换成一般形式，单纯形法的一般形式为：1）目标函数要求max；2）约束条件均为等式；3）决策变量为非负约束。 $$\max z = \sum_{ji=1}^{n}c_j x_j$$, $$\text{s.t.} \begin{cases} \sum_{j=1}^{n} a_{i,j} x_j = b_i \\ x_j \geq 0\end{cases}$$ 写成矩阵为：$$\begin{aligned} \max z &= CX \\ AX &= b \\ X &\geq 0 \end{aligned}$$
        + 若目标函数为最小化，可通过取负，求最大化；
        + 约束不等式为小于等于式，可在左端加入非负松弛变量，变为等式；约束为大于等于式子，可在左边减去非负松弛变量，变为等式；
        + 若存在无取值约束变量，可以转化成两个非负变量的差。
    + 在标准形中，有m个约束条件，n个决策变量，且$n \geq m$。首先寻找A的**基矩阵**（满秩的$m \times m$阶子矩阵），**基向量**则为基矩阵对应的列向量。其余列向量为**非基向量**。基向量对应的变量为**基变量**。
    + 对于某一确定的基向量，令非基变量等于0，求出基变量，称这组解为线性规划问题的**基本解**。若基本解满足$x \geq 0$的非负约束，称为基本可行解。
    + 几何意义，基变量可以通过非基变量的线性组合得到。当非基变量等于0时，基本解表示可行域的交点。
    + 求解思路：先求出一个初始基本可行解，并判断其是否最优，若不是最优，再换一个基本可行解并判断，直到得出最优解/无最优解。
+ 求解步骤：
    1. 化标准型，求初始基本可行解，建立初始单纯形表
    2. 求检验数 $\sigma_j = c_j = \sum_{i=1}^{m} c_i a_{i,j}$并判断，1）如果所有检验数都满足$\sigma_j \leq 0$，得到最优解；2）若存在检验数 $\sigma_k > 0$，且其对应的变量$x_k$的系数列向量$P_k \leq 0$，则为无界解。
    3. 选取检验数最大的一项为进基变量，选取$\theta_i$最小值对应的$x_i$为出基变量。
    4. 进行初等行变换，将$a_lk$化成1，该列的其他元素化成0；
    5. 重复上述过程，直到得到最优解。

### 进阶解法
**大M单纯形法**
当我们找到的基向量的个数小于约束条件时（若系数矩阵中不存在单位矩阵），我们可以添加人工变量，构成单位矩阵。
**最优解分析**：若线性规划有最优解，则人工变量必定为0。

**求解步骤**：
1. 1）如果目标函数求max，则人工变量在目标函数中的系数为-M，M为任意大的正数。因为如果我们要使目标函数实现最大化，必须把让人工变量从基变量中换出。使得检验数很大。2）如果目标函数求min，则人工变量在目标函数中系数为M。
2. 判断检验数，与基本单纯性法不同的是，如果所有检验数都满足小于等于0的条件，但是基变量中含有非零的人工变量，则没有可行解。

### 相关面经问题
**影子价格的意义是什么？**
当限制条件放宽一个单位之后，最优方案只是价格的变化。相当于是边际收益，类似于灵敏度分析。

**检验数的意义是什么？**
单纯形法中的检验数实际上就是该产品（变量）的市场价格与该产品的隐含成本之差。市场价格高于隐含成本，即检验数大于零时，则可将该产品投入生产，反之，不生产该产品。

## 分支定界法
分支定界法可以用来解决整数规划问题。原理是不断将线性规划问题的可行域分成子区域。逐步缩小最优目标函数值Z\*的上界和增加Z\*的下界，最终求得Z.
+ 上界：最优目标函数中的最大值作为新的上界，次数变量不必满足整数的约束条件；
+ 下界：在已经求出的整数条件的解中最大者为下界，若当前没有最大解，则为0。

**求解步骤**
1. 给定初始上界：求解线性规划问题的最优解，并将其目标函数值作为Z的初始上界；情节A的一个整数解，将目标函数值作为Z的初始下界；
2. 分支：选择可行域中B最优解中不满足整数条件的变量，添加约束将B分为两个子问题B1,B2，不考虑整数约束求解B1,B2的最优解；
3. 定界：比较各分支的解，将最优目标函数值的最大值作为新的上届；将各分支满足整数条件的解中最大者作为新的下届；
4. 剪枝：比较各分支的解，若小于新的下界，剪枝；若无可行解；剪枝；若大于新的下界，重复以上步骤。